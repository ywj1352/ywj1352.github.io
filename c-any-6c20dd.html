<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;♾️&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>c++ @any%&nbsp;|&nbsp;humblog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="c++ @any%">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;➕&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;♾️&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🌖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;➕&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">c++ @any%</h1>
    
  </header>
  <article id="https://www.notion.so/6c20ddd1689d4b238776cde4d5305098" class="PageRoot"><div id="https://www.notion.so/522a695929794bc09b9b19de8211e040" class="ColorfulBlock ColorfulBlock--BgGray Callout"><div class="Callout__Icon"><div class="Icon">💡</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString">Inheritance, polymorphism and encapsulation is core idea of C++（I hate Inheritance）</span></span></p></div><h1 id="https://www.notion.so/184e9ea17acc4fd98670eca2e53d3746" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/184e9ea17acc4fd98670eca2e53d3746"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Wandering</span></span></h1><h2 id="https://www.notion.so/f53cec1627444805b8d5f15a831a76df" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/f53cec1627444805b8d5f15a831a76df"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Mynote</span></span></h2><details id="https://www.notion.so/7d16f6f6667a4f90878b2f62cc0f0c96" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">引入 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">  效率会更高吗</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/1d3d90fc90a84b3285ba002b11322c29" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Yes, const can (not guaranteed) help the compiler produce faster/more correct code</strong></span><span class="SemanticString">.</span></span></p></div></div></details><details id="https://www.notion.so/d976397b97554e549063d02c44c0822a" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">memory layout </span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/f57d7a51b28d434b84c9e735d1f3945e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">cl /d1reportSingleClassLayout[ClassName] [filename].cpp</code></span><span class="SemanticString"> VS查看内存模型</span></span></p></div><div id="https://www.notion.so/ae153f7e12e947409d51fc3a8a184927" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">使用Clang++编译器，可以通过下面的命令导出</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">main.cpp</code></span><span class="SemanticString">中类型的内存模型和虚表模型。</span></span></p></div><div id="https://www.notion.so/959b3768d82949289a571d68918ae449" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"></span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">clang++ -cc1 -emit-llvm -fdump-record-layouts -fdump-vtable-layouts  main.cpp</code></span></span></p></div><div id="https://www.notion.so/74ddb6be93a2411db3c2009e1630dde3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">使用g++导出继承结构的指令如下：</span></span></p></div><div id="https://www.notion.so/e1a5e087ce384ee9846a31eeaaa0e3d3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">g++ -fdump-lang-class -c main.cpp</code></span></span></p></div><div id="https://www.notion.so/8fff554659314d2fbba8a24670fb5a8e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">由于g++的dump出的名称是其内部表示，因此还需要使用c++filt导出具有一定可读性的文档。</span></span></p></div><div id="https://www.notion.so/6e5e37c53b904a4d99ab36fd8af17ac2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"></span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">cat [g++导出的文档] | c++filt -n &gt; [具有一定可读性的输出文档]</code></span></span></p></div><div id="https://www.notion.so/6d0fbcdd5ca94d99b8779eb4c0f3156e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">此外，还可以通过gdb跟踪内存、寄存器的变化，观察虚函数、</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Thunk</code></span><span class="SemanticString">的寻址过程，以及</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">this</code></span><span class="SemanticString">指针的变化。</span></span></p></div><div id="https://www.notion.so/15735ad68aa34aaa9bbb595bd6573da0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对于g++，它采用了安腾ABI(Application Binary Interface)，如果想要更深入的了解其内存布局，可以参考安腾ABI文档。</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://link.zhihu.com/?target=https%3A//itanium-cxx-abi.github.io/cxx-abi/abi.html">Itanium C++ ABI</a></span></span></p></div><div id="https://www.notion.so/0afbcee2802d417bb13c904f6b3dfb3d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对于vc++，内存的布局稍有不同，它将虚基类的偏移量单独用一个额外的指针进行索引，因此对于虚继承的类，除了指向虚函数表的</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">vfptr</code></span><span class="SemanticString">外，还会在它的后面紧随有一个指向虚基类偏移量表的指针</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">vbptr</code></span><span class="SemanticString">。 除此之外，vc++将空子类的虚指针，或者或者具有与基类相同虚函数接口的派生类的虚指针与虚基类的虚指针进行合并，这意味着有的时候，对象的首个地址存放的可能是</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">vbptr</code></span><span class="SemanticString">而非</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">vfptr</code></span><span class="SemanticString">。</span></span></p></div></div></details><details id="https://www.notion.so/98d815650f96408082b493f34eaa1101" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">虚函数的坑</span></span></summary><div class="Toggle__Content"><ol class="NumberedListWrapper"><li id="https://www.notion.so/45ea9b2ba548450c996f99e5944e9ef3" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">为什么非虚函数的方法在基类指针指向派生类地址时，会坚持调用基类函数的实现方法？</span></span><div id="https://www.notion.so/9ea3d66e50fb46faa86d5d24f0e5088d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">原因：非虚函数是编译时确定，只看指针类型。</span></span></p></div></li><li id="https://www.notion.so/56c8098f543c4d86936cc2087d8ac0c2" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">C++中，</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://so.csdn.net/so/search?q=%E8%99%9A%E5%87%BD%E6%95%B0&amp;spm=1001.2101.3001.7020">虚函数</a></span><span class="SemanticString">是动态绑定的，但函数的缺省参数却是在编译时就静态绑定的。这意味着你最终执行的函数是一个定义在派生类，但使用了基类中的缺省参数值的虚函数。</span></span><div id="https://www.notion.so/f36b5d2a81824619acbfccdd3e37c4e9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">为了避免虚函数重载时，因参数声明不一致给使用者带来的困惑和由此导致的问题，</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">规定所有虚函数均不允许声明缺省参数值。</strong></span></span></p></div></li></ol></div></details><details id="https://www.notion.so/c0878a9dc50b431b8afebc06dc5c7b43" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">class</code></span><span class="SemanticString"> &amp; </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span></span></summary><div class="Toggle__Content"><ol class="NumberedListWrapper"><li id="https://www.notion.so/27dc389e7b4744eb886fc3bab492960a" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">对于类的成员函数，若指定其为</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">类型，则表明其是一个常函数，不能修改类的成员变量。一个没有明确声明为</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">的成员函数被看作是将要修改对象中数据成员的函数，而且编译器不允许它为一个</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">对象所调用。因此</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">对象只能调用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">成员函数</span></span></li><li id="https://www.notion.so/e6e1ee4812524072b5b4ff1e62703d24" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">类型变量可以通过类型转换符</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const_cast</code></span><span class="SemanticString">将</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">类型转换为</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">non-const</code></span><span class="SemanticString">类型</span></span></li><li id="https://www.notion.so/a5dd482964fe4288bfc8d0bfe3227d54" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">只有引用传递和指针传递可以用是否加</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">来重载。一个拥有顶层</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">的形参无法和另一个没有顶层</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">的形参区分开来</span></span></li><li id="https://www.notion.so/558f53a5250c418c96f54a9b685316c6" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">类型变量必须定义的时候进行初始化，因此也导致如果类的成员变量有</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString">类型的变量，那么该变量必须在类的初始化列表中进行初始化</span></span></li></ol><div id="https://www.notion.so/c4584495a96e427caa5db0adc41b8afe" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></div></details><details id="https://www.notion.so/a582b255e9be47b492bed2886e483892" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">class</code></span><span class="SemanticString"> &amp; </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">static</code></span></span></summary><div class="Toggle__Content"><ol class="NumberedListWrapper"><li id="https://www.notion.so/e2c56d1709d1499b8250d7a3594d26c7" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">static成员变量：只与类关联，不与类的对象关联。定义时要分配空间，不能在类声明中初始化，必须在类定义体外部初始化，初始化时不需要标示为static；可以被非static成员函数任意访问。</span></span></li><li id="https://www.notion.so/69fe6aaacbce4856b10003a6e6952da5" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">static成员函数：不具有this指针，无法访问类对象的非static成员变量和非static成员函数；</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">不能被声明为const、虚函数和volatile</strong></span><span class="SemanticString">；可以被非static成员函数任意访问</span></span></li><li id="https://www.notion.so/4983f43e6d42455e89a8aff938dc6b38" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">static 函数和 static 成员函数不是一个东西。同理，static 变量和 static 成员变量也不是一个东西。static 函数和 static 变量是C语言中的东西，只能在当前文件所在的编译模块中使用，对其他模块隐藏。而 static 成员函数和 static 成员变量是C++中引入的，其他编译模块可见，且只与类相关，与类实例无关。</span></span></li><li id="https://www.notion.so/07524c8758e7438aa5595c88b4b6cc9d" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">static 成员变量必须初始化（必须在类声明之后在类外进行初始化），但 static 变量默认为0，可以不初始化。</span></span><pre id="https://www.notion.so/14cb81cedc8d4f6fa4be724d06b22f7b" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

<span class="token comment">// int MyClass::count = 0; // BAD, 不能在类定义前初始化静态成员变量</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> foo<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">static</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span> <span class="token comment">// 静态成员变量，用于跟踪实例的数量</span>
  <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    count<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// 在构造函数中递增静态成员变量</span>
  <span class="token punctuation">}</span>
  <span class="token operator">~</span><span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    count<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">// 在析构函数中递减静态成员变量</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> count<span class="token punctuation">;</span> <span class="token comment">// 静态成员函数可以访问静态成员变量</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> MyClass<span class="token double-colon punctuation">::</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  MyClass obj1<span class="token punctuation">;</span>
  MyClass obj2<span class="token punctuation">;</span>
  MyClass obj3<span class="token punctuation">;</span>

  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Number of instances: "</span> <span class="token operator">&lt;&lt;</span> <span class="token class-name">MyClass</span><span class="token double-colon punctuation">::</span><span class="token function">GetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// 使用类名访问静态成员函数</span>
<span class="token punctuation">}</span></span></span></span></code></pre></li></ol></div></details><details id="https://www.notion.so/b2006723f84d44c89ba4076026595559" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">inline</code></span><span class="SemanticString"> &amp; </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">macro</code></span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/efd1eff7546a40eda0831fba1482c45c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">内联函数和宏很类似，而区别在于，宏是由预处理器对宏进行替代，而内联函数是通过编译器控制来实现的。而且内联函数是真正的函数，只是在需要用到的时候，内联函数像宏一样的展开，所以取消了函数的参数压栈，减少了调用的开销。</span></span></p></div></div></details><details id="https://www.notion.so/ca4acd6386cf4a06a1aacd2ae3c524e1" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">类如何实现只能静态分配和只能动态分配?</span></span></summary><div class="Toggle__Content"><ul class="BulletedListWrapper"><li id="https://www.notion.so/c4650a3c79c4478cb4c5228c263f2a98" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">static only: 把new、delete运算符重载为private属性。</span></span><pre id="https://www.notion.so/9f013803b10e42adb1bc5f7d4727c13b" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">void</span> <span class="token operator">*</span><span class="token keyword">operator</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>
  <span class="token keyword">void</span> <span class="token keyword">operator</span> <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  A a<span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre></li><li id="https://www.notion.so/7a3e74a0e6224b39a79be7b96dbeb06d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">dynamic only: 把构造、析构函数设为protected属性。</span></span><pre id="https://www.notion.so/62fd73a3e9994f5b8aad3e3804e95a59" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
  <span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token operator">~</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">static</span> A <span class="token operator">*</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">void</span> <span class="token function">destory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  A <span class="token operator">*</span>b <span class="token operator">=</span> <span class="token class-name">A</span><span class="token double-colon punctuation">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></span></span></span></code></pre></li></ul></div></details><details id="https://www.notion.so/63fce8dad57e4a91a1816a151527aee9" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString"> &amp; </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">delete</code></span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/7e94011f6dfe4308ac28d1373bf3a2c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString">:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/fbd0e06ece2242c7bfde105f306173af" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString">是类型安全的(可以静态语法检查)</span></span></li><li id="https://www.notion.so/9e36d4a4c73d42c38af4886a50679481" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString">首先调用名为</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">operator new</code></span><span class="SemanticString">的标准库函数，分配足够大的原始为类型化的内存，以保存指定类型的一个对象；接下来运行该类型的一个构造函数，用指定初始化构造对象；最后返回指向新分配并构造后的的对象的指针。</span></span></li></ul><div id="https://www.notion.so/6e5317c09c1346398347d5bfa2f68360" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">delete</code></span><span class="SemanticString">:</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/6280ced5b94c456e8a3502e94aad267e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">delete</code></span><span class="SemanticString">对指针指向的对象运行适当的析构函数；然后通过调用名为</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">operator delete</code></span><span class="SemanticString">的标准库函数释放该对象所用内存。所以在类的析构函数中调用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">delete this</code></span><span class="SemanticString">，会形成无限递归，造成堆栈溢出，系统崩溃。</span></span></li></ul></div></details><details id="https://www.notion.so/8d9af26ca3b94706b8a35786be0b6aaa" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">placement </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span></span></summary><div class="Toggle__Content"><ol class="NumberedListWrapper"><li id="https://www.notion.so/c08d88088e694dce929505b6c3243589" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">可以把对象</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString">在栈上</span></span></li><li id="https://www.notion.so/7d20d7073f664c4da8b6b48fec6091e7" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">把对象</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString">在已经</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">allocated</code></span><span class="SemanticString">的内存上，加快实例化速度。</span></span></li></ol></div></details><details id="https://www.notion.so/d163822d62bc41f6b868e1883caaf60d" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">只有引用传递和指针传递可以用是否加const来触发重载</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/3463521f60114705bf1b8dad69d42888" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一个拥有顶层const的形参无法和另一个没有顶层const的形参区分开来</span></span></p></div><pre id="https://www.notion.so/181392ce45934df4bdb838ae9fd43578" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// BAD, redefinition</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span></span></span></code></pre></div></details><details id="https://www.notion.so/eef807bf58144ccfba33cd53fce7bb11" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">const &amp; constexpr</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/06ca863a53574276a40fb8b712e29be7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString"> applies for </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">variables</strong></span><span class="SemanticString">, and </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">prevents them from being modified</strong></span><span class="SemanticString"> in your code.</span></span></p></div><div id="https://www.notion.so/5774470b08eb47d2aef1a66c83126996" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">constexpr</code></span><span class="SemanticString"> tells the compiler that this </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">expression</strong></span><span class="SemanticString"> results in a </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">compile time constant value</strong></span><span class="SemanticString">, so it can be used in places like array lengths, assigning to </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">const</code></span><span class="SemanticString"> variables, etc. The </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://stackoverflow.com/questions/4748083/when-should-you-use-constexpr-capability-in-c11">link</a></span><span class="SemanticString"> has a lot of excellent examples.</span></span></p></div></div></details><a id="https://www.notion.so/6def7829c6e04d01a2349a211975a3ca" class="Page" href="https://www.notion.so/6def7829c6e04d01a2349a211975a3ca"><div><div class="Page__Icon"><div class="Icon">✔️</div></div><div class="Page__Title"><span class="SemanticStringArray"><span class="SemanticString">rvalue-ref 从入门到入梦</span></span></div></div></a><a id="https://www.notion.so/d8954e92bcf541d9955433719b5bbf87" class="Page" href="https://www.notion.so/d8954e92bcf541d9955433719b5bbf87"><div><div class="Page__Icon"><div class="Icon">✔️</div></div><div class="Page__Title"><span class="SemanticStringArray"><span class="SemanticString">vptr &amp; vtable</span></span></div></div></a><a id="https://www.notion.so/bfcabe4bdf4644fba566e7c0ca0a4549" class="Page" href="https://www.notion.so/bfcabe4bdf4644fba566e7c0ca0a4549"><div><div class="Page__Icon"><div class="Icon">➕</div></div><div class="Page__Title"><span class="SemanticStringArray"><span class="SemanticString">Compiler</span></span></div></div></a><a id="https://www.notion.so/6365d4655f58417f8e0137ded03f0918" class="Page" href="https://www.notion.so/6365d4655f58417f8e0137ded03f0918"><div><div class="Page__Icon"><div class="Icon">➕</div></div><div class="Page__Title"><span class="SemanticStringArray"><span class="SemanticString">smart pointer</span></span></div></div></a><a id="https://www.notion.so/5cb071f4768f449f817386eaa2344a9e" class="Page" href="https://www.notion.so/5cb071f4768f449f817386eaa2344a9e"><div><div class="Page__Icon"><div class="Icon">➕</div></div><div class="Page__Title"><span class="SemanticStringArray"><span class="SemanticString">cast * 4</span></span></div></div></a><a id="https://www.notion.so/26bf40bd0529449f90081a7f05843b68" class="Page" href="https://www.notion.so/26bf40bd0529449f90081a7f05843b68"><div><div class="Page__Icon"><div class="Icon">➕</div></div><div class="Page__Title"><span class="SemanticStringArray"><span class="SemanticString">STL</span></span></div></div></a><h2 id="https://www.notion.so/ac491320431a4428a20d660b5ca6b23c" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ac491320431a4428a20d660b5ca6b23c"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Trail</span></span></h2><div id="https://www.notion.so/a813dc9725504068bad909fdbfa9682f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://stackoverflow.com/questions/57483/what-are-the-differences-between-a-pointer-variable-and-a-reference-variable">Difference between a pointer variable and a reference variable</a></strong></span></span></p></div><div id="https://www.notion.so/b7470b1ff89649d983473092c62dc47d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://stackoverflow.com/questions/2209224/vector-vs-list-in-stl"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">vector vs. list in STL</strong></a></span></span></p></div><div id="https://www.notion.so/9b0ac63bc7314b53a567bb160d9ec706" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://stackoverflow.com/questions/2227516/in-c-how-is-function-overloading-typically-implemented"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">In C++ how is function overloading typically implemented?</strong></a></span></span></p></div><div id="https://www.notion.so/99fb716280b04aecb611bfc702be9d29" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <footer class="Footer">
  <div>&copy; humblog 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>